<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Race by Year – Michigan</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin: 1em;
    }
    #buttons button {
      margin: 0 5px;
    }
    #chart-container {
      width: 90%;
      max-width: 800px;
      margin: auto;
    }
    
    #buttons button.active {
  background-color: dodgerblue;
  color: white;
  border: none;
  border-radius: 4px;
}

  </style>
</head>
<body>
  <h2>Race/Ethnicity Population – Michigan</h2>

  <label for="countySelect">County:</label>
  <select id="countySelect">
    <option value="Statewide" selected>Statewide</option>
<option value="Alcona County">Alcona County</option>
<option value="Alger County">Alger County</option>
<option value="Allegan County">Allegan County</option>
<option value="Alpena County">Alpena County</option>
<option value="Antrim County">Antrim County</option>
<option value="Arenac County">Arenac County</option>
<option value="Baraga County">Baraga County</option>
<option value="Barry County">Barry County</option>
<option value="Bay County">Bay County</option>
<option value="Benzie County">Benzie County</option>
<option value="Berrien County">Berrien County</option>
<option value="Branch County">Branch County</option>
<option value="Calhoun County">Calhoun County</option>
<option value="Cass County">Cass County</option>
<option value="Charlevoix County">Charlevoix County</option>
<option value="Cheboygan County">Cheboygan County</option>
<option value="Chippewa County">Chippewa County</option>
<option value="Clare County">Clare County</option>
<option value="Clinton County">Clinton County</option>
<option value="Crawford County">Crawford County</option>
<option value="Delta County">Delta County</option>
<option value="Dickinson County">Dickinson County</option>
<option value="Eaton County">Eaton County</option>
<option value="Emmet County">Emmet County</option>
<option value="Genesee County">Genesee County</option>
<option value="Gladwin County">Gladwin County</option>
<option value="Gogebic County">Gogebic County</option>
<option value="Grand Traverse County">Grand Traverse County</option>
<option value="Gratiot County">Gratiot County</option>
<option value="Hillsdale County">Hillsdale County</option>
<option value="Houghton County">Houghton County</option>
<option value="Huron County">Huron County</option>
<option value="Ingham County">Ingham County</option>
<option value="Ionia County">Ionia County</option>
<option value="Iosco County">Iosco County</option>
<option value="Iron County">Iron County</option>
<option value="Isabella County">Isabella County</option>
<option value="Jackson County">Jackson County</option>
<option value="Kalamazoo County">Kalamazoo County</option>
<option value="Kalkaska County">Kalkaska County</option>
<option value="Kent County">Kent County</option>
<option value="Keweenaw County">Keweenaw County</option>
<option value="Lake County">Lake County</option>
<option value="Lapeer County">Lapeer County</option>
<option value="Leelanau County">Leelanau County</option>
<option value="Lenawee County">Lenawee County</option>
<option value="Livingston County">Livingston County</option>
<option value="Luce County">Luce County</option>
<option value="Mackinac County">Mackinac County</option>
<option value="Macomb County">Macomb County</option>
<option value="Manistee County">Manistee County</option>
<option value="Marquette County">Marquette County</option>
<option value="Mason County">Mason County</option>
<option value="Mecosta County">Mecosta County</option>
<option value="Menominee County">Menominee County</option>
<option value="Midland County">Midland County</option>
<option value="Missaukee County">Missaukee County</option>
<option value="Monroe County">Monroe County</option>
<option value="Montcalm County">Montcalm County</option>
<option value="Montmorency County">Montmorency County</option>
<option value="Muskegon County">Muskegon County</option>
<option value="Newaygo County">Newaygo County</option>
<option value="Oakland County">Oakland County</option>
<option value="Oceana County">Oceana County</option>
<option value="Ogemaw County">Ogemaw County</option>
<option value="Ontonagon County">Ontonagon County</option>
<option value="Osceola County">Osceola County</option>
<option value="Oscoda County">Oscoda County</option>
<option value="Otsego County">Otsego County</option>
<option value="Ottawa County">Ottawa County</option>
<option value="Presque Isle County">Presque Isle County</option>
<option value="Roscommon County">Roscommon County</option>
<option value="Saginaw County">Saginaw County</option>
<option value="Sanilac County">Sanilac County</option>
<option value="Schoolcraft County">Schoolcraft County</option>
<option value="Shiawassee County">Shiawassee County</option>
<option value="St. Clair County">St. Clair County</option>
<option value="St. Joseph County">St. Joseph County</option>
<option value="Tuscola County">Tuscola County</option>
<option value="Van Buren County">Van Buren County</option>
<option value="Washtenaw County">Washtenaw County</option>
<option value="Wayne County">Wayne County</option>
<option value="Wexford County">Wexford County</option>
  </select>

  <div id="buttons">
  <button id="btn2010" onclick="updateChart(2010)">2010</button>
  <button id="btn2020" onclick="updateChart(2020)">2020</button>
</div>

  <div id="chart-container">
    <canvas id="raceChart"></canvas>
  </div>

   <script>
    let data = null;
    let chart = null;
    let currentYear = 2010;

    fetch("26.json")
      .then(res => res.json())
      .then(json => {
        data = json;
        document.getElementById("countySelect").addEventListener("change", () => updateChart(currentYear));
        updateChart(currentYear);
      });

    function updateChart(year) {
      currentYear = year;

      // Highlight selected button
      document.querySelectorAll("#buttons button").forEach(btn => btn.classList.remove("active"));
      const activeBtn = document.getElementById(`btn${year}`);
      if (activeBtn) activeBtn.classList.add("active");

      const county = document.getElementById("countySelect").value;
      const entry = data[county] && data[county][year];
      if (!entry) return;

      const races = Object.keys(entry[0]).filter(k => !["state_fips", "county", "year", "total"].includes(k));
      const values = races.map(r => entry[0][r]);

      const config = {
        type: "bar",
        data: {
          labels: races,
          datasets: [{
            label: "Population",
            data: values,
            backgroundColor: "dodgerblue"
          }]
        },
        options: {
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return value.toLocaleString();
                }
              }
            }
          }
        }
      };

      if (chart) {
        chart.destroy();
      }
      chart = new Chart(document.getElementById("raceChart"), config);
    }
  </script>
</body>
</html>
