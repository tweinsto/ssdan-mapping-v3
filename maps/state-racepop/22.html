<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Race by Year – Louisiana</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin: 1em;
    }
    #buttons button {
      margin: 0 5px;
    }
    #chart-container {
      width: 90%;
      max-width: 800px;
      margin: auto;
    }
    
    #buttons button.active {
  background-color: dodgerblue;
  color: white;
  border: none;
  border-radius: 4px;
}

  </style>
</head>
<body>
  <h2>Race/Ethnicity Population – Louisiana</h2>

  <label for="countySelect">County:</label>
  <select id="countySelect">
    <option value="Statewide" selected>Statewide</option>
<option value="Acadia Parish">Acadia Parish</option>
<option value="Allen Parish">Allen Parish</option>
<option value="Ascension Parish">Ascension Parish</option>
<option value="Assumption Parish">Assumption Parish</option>
<option value="Avoyelles Parish">Avoyelles Parish</option>
<option value="Beauregard Parish">Beauregard Parish</option>
<option value="Bienville Parish">Bienville Parish</option>
<option value="Bossier Parish">Bossier Parish</option>
<option value="Caddo Parish">Caddo Parish</option>
<option value="Calcasieu Parish">Calcasieu Parish</option>
<option value="Caldwell Parish">Caldwell Parish</option>
<option value="Cameron Parish">Cameron Parish</option>
<option value="Catahoula Parish">Catahoula Parish</option>
<option value="Claiborne Parish">Claiborne Parish</option>
<option value="Concordia Parish">Concordia Parish</option>
<option value="De Soto Parish">De Soto Parish</option>
<option value="East Baton Rouge Parish">East Baton Rouge Parish</option>
<option value="East Carroll Parish">East Carroll Parish</option>
<option value="East Feliciana Parish">East Feliciana Parish</option>
<option value="Evangeline Parish">Evangeline Parish</option>
<option value="Franklin Parish">Franklin Parish</option>
<option value="Grant Parish">Grant Parish</option>
<option value="Iberia Parish">Iberia Parish</option>
<option value="Iberville Parish">Iberville Parish</option>
<option value="Jackson Parish">Jackson Parish</option>
<option value="Jefferson Davis Parish">Jefferson Davis Parish</option>
<option value="Jefferson Parish">Jefferson Parish</option>
<option value="La Salle Parish">La Salle Parish</option>
<option value="Lafayette Parish">Lafayette Parish</option>
<option value="Lafourche Parish">Lafourche Parish</option>
<option value="LaSalle Parish">LaSalle Parish</option>
<option value="Lincoln Parish">Lincoln Parish</option>
<option value="Livingston Parish">Livingston Parish</option>
<option value="Madison Parish">Madison Parish</option>
<option value="Morehouse Parish">Morehouse Parish</option>
<option value="Natchitoches Parish">Natchitoches Parish</option>
<option value="Orleans Parish">Orleans Parish</option>
<option value="Ouachita Parish">Ouachita Parish</option>
<option value="Plaquemines Parish">Plaquemines Parish</option>
<option value="Pointe Coupee Parish">Pointe Coupee Parish</option>
<option value="Rapides Parish">Rapides Parish</option>
<option value="Red River Parish">Red River Parish</option>
<option value="Richland Parish">Richland Parish</option>
<option value="Sabine Parish">Sabine Parish</option>
<option value="St. Bernard Parish">St. Bernard Parish</option>
<option value="St. Charles Parish">St. Charles Parish</option>
<option value="St. Helena Parish">St. Helena Parish</option>
<option value="St. James Parish">St. James Parish</option>
<option value="St. John the Baptist Parish">St. John the Baptist Parish</option>
<option value="St. Landry Parish">St. Landry Parish</option>
<option value="St. Martin Parish">St. Martin Parish</option>
<option value="St. Mary Parish">St. Mary Parish</option>
<option value="St. Tammany Parish">St. Tammany Parish</option>
<option value="Tangipahoa Parish">Tangipahoa Parish</option>
<option value="Tensas Parish">Tensas Parish</option>
<option value="Terrebonne Parish">Terrebonne Parish</option>
<option value="Union Parish">Union Parish</option>
<option value="Vermilion Parish">Vermilion Parish</option>
<option value="Vernon Parish">Vernon Parish</option>
<option value="Washington Parish">Washington Parish</option>
<option value="Webster Parish">Webster Parish</option>
<option value="West Baton Rouge Parish">West Baton Rouge Parish</option>
<option value="West Carroll Parish">West Carroll Parish</option>
<option value="West Feliciana Parish">West Feliciana Parish</option>
<option value="Winn Parish">Winn Parish</option>
  </select>

  <div id="buttons">
  <button id="btn2010" onclick="updateChart(2010)">2010</button>
  <button id="btn2020" onclick="updateChart(2020)">2020</button>
</div>

  <div id="chart-container">
    <canvas id="raceChart"></canvas>
  </div>

   <script>
    let data = null;
    let chart = null;
    let currentYear = 2010;

    fetch("22.json")
      .then(res => res.json())
      .then(json => {
        data = json;
        document.getElementById("countySelect").addEventListener("change", () => updateChart(currentYear));
        updateChart(currentYear);
      });

    function updateChart(year) {
      currentYear = year;

      // Highlight selected button
      document.querySelectorAll("#buttons button").forEach(btn => btn.classList.remove("active"));
      const activeBtn = document.getElementById(`btn${year}`);
      if (activeBtn) activeBtn.classList.add("active");

      const county = document.getElementById("countySelect").value;
      const entry = data[county] && data[county][year];
      if (!entry) return;

      const races = Object.keys(entry[0]).filter(k => !["state_fips", "county", "year", "total"].includes(k));
      const values = races.map(r => entry[0][r]);

      const config = {
        type: "bar",
        data: {
          labels: races,
          datasets: [{
            label: "Population",
            data: values,
            backgroundColor: "dodgerblue"
          }]
        },
        options: {
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return value.toLocaleString();
                }
              }
            }
          }
        }
      };

      if (chart) {
        chart.destroy();
      }
      chart = new Chart(document.getElementById("raceChart"), config);
    }
  </script>
</body>
</html>
