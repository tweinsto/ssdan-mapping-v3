<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Race by Year – Minnesota</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin: 1em;
    }
    #buttons button {
      margin: 0 5px;
    }
    #chart-container {
      width: 90%;
      max-width: 800px;
      margin: auto;
    }
    
    #buttons button.active {
  background-color: dodgerblue;
  color: white;
  border: none;
  border-radius: 4px;
}

  </style>
</head>
<body>
  <h2>Race/Ethnicity Population – Minnesota</h2>

  <label for="countySelect">County:</label>
  <select id="countySelect">
    <option value="Statewide" selected>Statewide</option>
<option value="Aitkin County">Aitkin County</option>
<option value="Anoka County">Anoka County</option>
<option value="Becker County">Becker County</option>
<option value="Beltrami County">Beltrami County</option>
<option value="Benton County">Benton County</option>
<option value="Big Stone County">Big Stone County</option>
<option value="Blue Earth County">Blue Earth County</option>
<option value="Brown County">Brown County</option>
<option value="Carlton County">Carlton County</option>
<option value="Carver County">Carver County</option>
<option value="Cass County">Cass County</option>
<option value="Chippewa County">Chippewa County</option>
<option value="Chisago County">Chisago County</option>
<option value="Clay County">Clay County</option>
<option value="Clearwater County">Clearwater County</option>
<option value="Cook County">Cook County</option>
<option value="Cottonwood County">Cottonwood County</option>
<option value="Crow Wing County">Crow Wing County</option>
<option value="Dakota County">Dakota County</option>
<option value="Dodge County">Dodge County</option>
<option value="Douglas County">Douglas County</option>
<option value="Faribault County">Faribault County</option>
<option value="Fillmore County">Fillmore County</option>
<option value="Freeborn County">Freeborn County</option>
<option value="Goodhue County">Goodhue County</option>
<option value="Grant County">Grant County</option>
<option value="Hennepin County">Hennepin County</option>
<option value="Houston County">Houston County</option>
<option value="Hubbard County">Hubbard County</option>
<option value="Isanti County">Isanti County</option>
<option value="Itasca County">Itasca County</option>
<option value="Jackson County">Jackson County</option>
<option value="Kanabec County">Kanabec County</option>
<option value="Kandiyohi County">Kandiyohi County</option>
<option value="Kittson County">Kittson County</option>
<option value="Koochiching County">Koochiching County</option>
<option value="Lac qui Parle County">Lac qui Parle County</option>
<option value="Lake County">Lake County</option>
<option value="Lake of the Woods County">Lake of the Woods County</option>
<option value="Le Sueur County">Le Sueur County</option>
<option value="Lincoln County">Lincoln County</option>
<option value="Lyon County">Lyon County</option>
<option value="Mahnomen County">Mahnomen County</option>
<option value="Marshall County">Marshall County</option>
<option value="Martin County">Martin County</option>
<option value="McLeod County">McLeod County</option>
<option value="Meeker County">Meeker County</option>
<option value="Mille Lacs County">Mille Lacs County</option>
<option value="Morrison County">Morrison County</option>
<option value="Mower County">Mower County</option>
<option value="Murray County">Murray County</option>
<option value="Nicollet County">Nicollet County</option>
<option value="Nobles County">Nobles County</option>
<option value="Norman County">Norman County</option>
<option value="Olmsted County">Olmsted County</option>
<option value="Otter Tail County">Otter Tail County</option>
<option value="Pennington County">Pennington County</option>
<option value="Pine County">Pine County</option>
<option value="Pipestone County">Pipestone County</option>
<option value="Polk County">Polk County</option>
<option value="Pope County">Pope County</option>
<option value="Ramsey County">Ramsey County</option>
<option value="Red Lake County">Red Lake County</option>
<option value="Redwood County">Redwood County</option>
<option value="Renville County">Renville County</option>
<option value="Rice County">Rice County</option>
<option value="Rock County">Rock County</option>
<option value="Roseau County">Roseau County</option>
<option value="Scott County">Scott County</option>
<option value="Sherburne County">Sherburne County</option>
<option value="Sibley County">Sibley County</option>
<option value="St. Louis County">St. Louis County</option>
<option value="Stearns County">Stearns County</option>
<option value="Steele County">Steele County</option>
<option value="Stevens County">Stevens County</option>
<option value="Swift County">Swift County</option>
<option value="Todd County">Todd County</option>
<option value="Traverse County">Traverse County</option>
<option value="Wabasha County">Wabasha County</option>
<option value="Wadena County">Wadena County</option>
<option value="Waseca County">Waseca County</option>
<option value="Washington County">Washington County</option>
<option value="Watonwan County">Watonwan County</option>
<option value="Wilkin County">Wilkin County</option>
<option value="Winona County">Winona County</option>
<option value="Wright County">Wright County</option>
<option value="Yellow Medicine County">Yellow Medicine County</option>
  </select>

  <div id="buttons">
  <button id="btn2010" onclick="updateChart(2010)">2010</button>
  <button id="btn2020" onclick="updateChart(2020)">2020</button>
</div>

  <div id="chart-container">
    <canvas id="raceChart"></canvas>
  </div>

   <script>
    let data = null;
    let chart = null;
    let currentYear = 2010;

    fetch("27.json")
      .then(res => res.json())
      .then(json => {
        data = json;
        document.getElementById("countySelect").addEventListener("change", () => updateChart(currentYear));
        updateChart(currentYear);
      });

    function updateChart(year) {
      currentYear = year;

      // Highlight selected button
      document.querySelectorAll("#buttons button").forEach(btn => btn.classList.remove("active"));
      const activeBtn = document.getElementById(`btn${year}`);
      if (activeBtn) activeBtn.classList.add("active");

      const county = document.getElementById("countySelect").value;
      const entry = data[county] && data[county][year];
      if (!entry) return;

      const races = Object.keys(entry[0]).filter(k => !["state_fips", "county", "year", "total"].includes(k));
      const values = races.map(r => entry[0][r]);

      const config = {
        type: "bar",
        data: {
          labels: races,
          datasets: [{
            label: "Population",
            data: values,
            backgroundColor: "dodgerblue"
          }]
        },
        options: {
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return value.toLocaleString();
                }
              }
            }
          }
        }
      };

      if (chart) {
        chart.destroy();
      }
      chart = new Chart(document.getElementById("raceChart"), config);
    }
  </script>
</body>
</html>
