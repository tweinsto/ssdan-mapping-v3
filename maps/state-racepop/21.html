<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Race by Year – Kentucky</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin: 1em;
    }
    #buttons button {
      margin: 0 5px;
    }
    #chart-container {
      width: 90%;
      max-width: 800px;
      margin: auto;
    }
    
    #buttons button.active {
  background-color: dodgerblue;
  color: white;
  border: none;
  border-radius: 4px;
}

  </style>
</head>
<body>
  <h2>Race/Ethnicity Population – Kentucky</h2>

  <label for="countySelect">County:</label>
  <select id="countySelect">
    <option value="Statewide" selected>Statewide</option>
<option value="Adair County">Adair County</option>
<option value="Allen County">Allen County</option>
<option value="Anderson County">Anderson County</option>
<option value="Ballard County">Ballard County</option>
<option value="Barren County">Barren County</option>
<option value="Bath County">Bath County</option>
<option value="Bell County">Bell County</option>
<option value="Boone County">Boone County</option>
<option value="Bourbon County">Bourbon County</option>
<option value="Boyd County">Boyd County</option>
<option value="Boyle County">Boyle County</option>
<option value="Bracken County">Bracken County</option>
<option value="Breathitt County">Breathitt County</option>
<option value="Breckinridge County">Breckinridge County</option>
<option value="Bullitt County">Bullitt County</option>
<option value="Butler County">Butler County</option>
<option value="Caldwell County">Caldwell County</option>
<option value="Calloway County">Calloway County</option>
<option value="Campbell County">Campbell County</option>
<option value="Carlisle County">Carlisle County</option>
<option value="Carroll County">Carroll County</option>
<option value="Carter County">Carter County</option>
<option value="Casey County">Casey County</option>
<option value="Christian County">Christian County</option>
<option value="Clark County">Clark County</option>
<option value="Clay County">Clay County</option>
<option value="Clinton County">Clinton County</option>
<option value="Crittenden County">Crittenden County</option>
<option value="Cumberland County">Cumberland County</option>
<option value="Daviess County">Daviess County</option>
<option value="Edmonson County">Edmonson County</option>
<option value="Elliott County">Elliott County</option>
<option value="Estill County">Estill County</option>
<option value="Fayette County">Fayette County</option>
<option value="Fleming County">Fleming County</option>
<option value="Floyd County">Floyd County</option>
<option value="Franklin County">Franklin County</option>
<option value="Fulton County">Fulton County</option>
<option value="Gallatin County">Gallatin County</option>
<option value="Garrard County">Garrard County</option>
<option value="Grant County">Grant County</option>
<option value="Graves County">Graves County</option>
<option value="Grayson County">Grayson County</option>
<option value="Green County">Green County</option>
<option value="Greenup County">Greenup County</option>
<option value="Hancock County">Hancock County</option>
<option value="Hardin County">Hardin County</option>
<option value="Harlan County">Harlan County</option>
<option value="Harrison County">Harrison County</option>
<option value="Hart County">Hart County</option>
<option value="Henderson County">Henderson County</option>
<option value="Henry County">Henry County</option>
<option value="Hickman County">Hickman County</option>
<option value="Hopkins County">Hopkins County</option>
<option value="Jackson County">Jackson County</option>
<option value="Jefferson County">Jefferson County</option>
<option value="Jessamine County">Jessamine County</option>
<option value="Johnson County">Johnson County</option>
<option value="Kenton County">Kenton County</option>
<option value="Knott County">Knott County</option>
<option value="Knox County">Knox County</option>
<option value="Larue County">Larue County</option>
<option value="Laurel County">Laurel County</option>
<option value="Lawrence County">Lawrence County</option>
<option value="Lee County">Lee County</option>
<option value="Leslie County">Leslie County</option>
<option value="Letcher County">Letcher County</option>
<option value="Lewis County">Lewis County</option>
<option value="Lincoln County">Lincoln County</option>
<option value="Livingston County">Livingston County</option>
<option value="Logan County">Logan County</option>
<option value="Lyon County">Lyon County</option>
<option value="Madison County">Madison County</option>
<option value="Magoffin County">Magoffin County</option>
<option value="Marion County">Marion County</option>
<option value="Marshall County">Marshall County</option>
<option value="Martin County">Martin County</option>
<option value="Mason County">Mason County</option>
<option value="McCracken County">McCracken County</option>
<option value="McCreary County">McCreary County</option>
<option value="McLean County">McLean County</option>
<option value="Meade County">Meade County</option>
<option value="Menifee County">Menifee County</option>
<option value="Mercer County">Mercer County</option>
<option value="Metcalfe County">Metcalfe County</option>
<option value="Monroe County">Monroe County</option>
<option value="Montgomery County">Montgomery County</option>
<option value="Morgan County">Morgan County</option>
<option value="Muhlenberg County">Muhlenberg County</option>
<option value="Nelson County">Nelson County</option>
<option value="Nicholas County">Nicholas County</option>
<option value="Ohio County">Ohio County</option>
<option value="Oldham County">Oldham County</option>
<option value="Owen County">Owen County</option>
<option value="Owsley County">Owsley County</option>
<option value="Pendleton County">Pendleton County</option>
<option value="Perry County">Perry County</option>
<option value="Pike County">Pike County</option>
<option value="Powell County">Powell County</option>
<option value="Pulaski County">Pulaski County</option>
<option value="Robertson County">Robertson County</option>
<option value="Rockcastle County">Rockcastle County</option>
<option value="Rowan County">Rowan County</option>
<option value="Russell County">Russell County</option>
<option value="Scott County">Scott County</option>
<option value="Shelby County">Shelby County</option>
<option value="Simpson County">Simpson County</option>
<option value="Spencer County">Spencer County</option>
<option value="Taylor County">Taylor County</option>
<option value="Todd County">Todd County</option>
<option value="Trigg County">Trigg County</option>
<option value="Trimble County">Trimble County</option>
<option value="Union County">Union County</option>
<option value="Warren County">Warren County</option>
<option value="Washington County">Washington County</option>
<option value="Wayne County">Wayne County</option>
<option value="Webster County">Webster County</option>
<option value="Whitley County">Whitley County</option>
<option value="Wolfe County">Wolfe County</option>
<option value="Woodford County">Woodford County</option>
  </select>

  <div id="buttons">
  <button id="btn2010" onclick="updateChart(2010)">2010</button>
  <button id="btn2020" onclick="updateChart(2020)">2020</button>
</div>

  <div id="chart-container">
    <canvas id="raceChart"></canvas>
  </div>

   <script>
    let data = null;
    let chart = null;
    let currentYear = 2010;

    fetch("21.json")
      .then(res => res.json())
      .then(json => {
        data = json;
        document.getElementById("countySelect").addEventListener("change", () => updateChart(currentYear));
        updateChart(currentYear);
      });

    function updateChart(year) {
      currentYear = year;

      // Highlight selected button
      document.querySelectorAll("#buttons button").forEach(btn => btn.classList.remove("active"));
      const activeBtn = document.getElementById(`btn${year}`);
      if (activeBtn) activeBtn.classList.add("active");

      const county = document.getElementById("countySelect").value;
      const entry = data[county] && data[county][year];
      if (!entry) return;

      const races = Object.keys(entry[0]).filter(k => !["state_fips", "county", "year", "total"].includes(k));
      const values = races.map(r => entry[0][r]);

      const config = {
        type: "bar",
        data: {
          labels: races,
          datasets: [{
            label: "Population",
            data: values,
            backgroundColor: "dodgerblue"
          }]
        },
        options: {
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return value.toLocaleString();
                }
              }
            }
          }
        }
      };

      if (chart) {
        chart.destroy();
      }
      chart = new Chart(document.getElementById("raceChart"), config);
    }
  </script>
</body>
</html>
