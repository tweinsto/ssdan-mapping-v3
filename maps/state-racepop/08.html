<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Race by Year – Colorado</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin: 1em;
    }
    #buttons button {
      margin: 0 5px;
    }
    #chart-container {
      width: 90%;
      max-width: 800px;
      margin: auto;
    }
    
    #buttons button.active {
  background-color: dodgerblue;
  color: white;
  border: none;
  border-radius: 4px;
}

  </style>
</head>
<body>
  <h2>Race/Ethnicity Population – Colorado</h2>

  <label for="countySelect">County:</label>
  <select id="countySelect">
    <option value="Statewide" selected>Statewide</option>
<option value="Adams County">Adams County</option>
<option value="Alamosa County">Alamosa County</option>
<option value="Arapahoe County">Arapahoe County</option>
<option value="Archuleta County">Archuleta County</option>
<option value="Baca County">Baca County</option>
<option value="Bent County">Bent County</option>
<option value="Boulder County">Boulder County</option>
<option value="Broomfield County">Broomfield County</option>
<option value="Chaffee County">Chaffee County</option>
<option value="Cheyenne County">Cheyenne County</option>
<option value="Clear Creek County">Clear Creek County</option>
<option value="Conejos County">Conejos County</option>
<option value="Costilla County">Costilla County</option>
<option value="Crowley County">Crowley County</option>
<option value="Custer County">Custer County</option>
<option value="Delta County">Delta County</option>
<option value="Denver County">Denver County</option>
<option value="Dolores County">Dolores County</option>
<option value="Douglas County">Douglas County</option>
<option value="Eagle County">Eagle County</option>
<option value="El Paso County">El Paso County</option>
<option value="Elbert County">Elbert County</option>
<option value="Fremont County">Fremont County</option>
<option value="Garfield County">Garfield County</option>
<option value="Gilpin County">Gilpin County</option>
<option value="Grand County">Grand County</option>
<option value="Gunnison County">Gunnison County</option>
<option value="Hinsdale County">Hinsdale County</option>
<option value="Huerfano County">Huerfano County</option>
<option value="Jackson County">Jackson County</option>
<option value="Jefferson County">Jefferson County</option>
<option value="Kiowa County">Kiowa County</option>
<option value="Kit Carson County">Kit Carson County</option>
<option value="La Plata County">La Plata County</option>
<option value="Lake County">Lake County</option>
<option value="Larimer County">Larimer County</option>
<option value="Las Animas County">Las Animas County</option>
<option value="Lincoln County">Lincoln County</option>
<option value="Logan County">Logan County</option>
<option value="Mesa County">Mesa County</option>
<option value="Mineral County">Mineral County</option>
<option value="Moffat County">Moffat County</option>
<option value="Montezuma County">Montezuma County</option>
<option value="Montrose County">Montrose County</option>
<option value="Morgan County">Morgan County</option>
<option value="Otero County">Otero County</option>
<option value="Ouray County">Ouray County</option>
<option value="Park County">Park County</option>
<option value="Phillips County">Phillips County</option>
<option value="Pitkin County">Pitkin County</option>
<option value="Prowers County">Prowers County</option>
<option value="Pueblo County">Pueblo County</option>
<option value="Rio Blanco County">Rio Blanco County</option>
<option value="Rio Grande County">Rio Grande County</option>
<option value="Routt County">Routt County</option>
<option value="Saguache County">Saguache County</option>
<option value="San Juan County">San Juan County</option>
<option value="San Miguel County">San Miguel County</option>
<option value="Sedgwick County">Sedgwick County</option>
<option value="Summit County">Summit County</option>
<option value="Teller County">Teller County</option>
<option value="Washington County">Washington County</option>
<option value="Weld County">Weld County</option>
<option value="Yuma County">Yuma County</option>
  </select>

  <div id="buttons">
  <button id="btn2010" onclick="updateChart(2010)">2010</button>
  <button id="btn2020" onclick="updateChart(2020)">2020</button>
</div>

  <div id="chart-container">
    <canvas id="raceChart"></canvas>
  </div>

   <script>
    let data = null;
    let chart = null;
    let currentYear = 2010;

    fetch("08.json")
      .then(res => res.json())
      .then(json => {
        data = json;
        document.getElementById("countySelect").addEventListener("change", () => updateChart(currentYear));
        updateChart(currentYear);
      });

    function updateChart(year) {
      currentYear = year;

      // Highlight selected button
      document.querySelectorAll("#buttons button").forEach(btn => btn.classList.remove("active"));
      const activeBtn = document.getElementById(`btn${year}`);
      if (activeBtn) activeBtn.classList.add("active");

      const county = document.getElementById("countySelect").value;
      const entry = data[county] && data[county][year];
      if (!entry) return;

      const races = Object.keys(entry[0]).filter(k => !["state_fips", "county", "year", "total"].includes(k));
      const values = races.map(r => entry[0][r]);

      const config = {
        type: "bar",
        data: {
          labels: races,
          datasets: [{
            label: "Population",
            data: values,
            backgroundColor: "dodgerblue"
          }]
        },
        options: {
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return value.toLocaleString();
                }
              }
            }
          }
        }
      };

      if (chart) {
        chart.destroy();
      }
      chart = new Chart(document.getElementById("raceChart"), config);
    }
  </script>
</body>
</html>
