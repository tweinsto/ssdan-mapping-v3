<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<style>body{background-color:white;}</style>

  <meta charset="UTF-8"/>
  <title>Age Pyramid –  California</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
      body {
        font-family: sans-serif;
        margin: 1rem 2rem;
        text-align: center;
      }
      h2 {
        margin-bottom: 0.25rem;
        font-size: 1.6rem;
      }
      select {
        padding: 0.4rem;
        font-size: 1rem;
        margin: 1rem 0;
        border-radius: 5px;
        border: 1px solid #999;
      }
      canvas {
        width: 100%;
        max-width: 850px;
        height: 500px;
        margin-top: 1rem;
      }
    </style>
</head>
<html>
  <body>
    <h2>Age Distribution in  California (2023)</h2>
    <label>Select County:</label>
          <select id="countySelect">
        <option value='Statewide'>Statewide</option>
<option value='Alameda County, California'>Alameda County, California</option>
<option value='Alpine County, California'>Alpine County, California</option>
<option value='Amador County, California'>Amador County, California</option>
<option value='Butte County, California'>Butte County, California</option>
<option value='Calaveras County, California'>Calaveras County, California</option>
<option value='Colusa County, California'>Colusa County, California</option>
<option value='Contra Costa County, California'>Contra Costa County, California</option>
<option value='Del Norte County, California'>Del Norte County, California</option>
<option value='El Dorado County, California'>El Dorado County, California</option>
<option value='Fresno County, California'>Fresno County, California</option>
<option value='Glenn County, California'>Glenn County, California</option>
<option value='Humboldt County, California'>Humboldt County, California</option>
<option value='Imperial County, California'>Imperial County, California</option>
<option value='Inyo County, California'>Inyo County, California</option>
<option value='Kern County, California'>Kern County, California</option>
<option value='Kings County, California'>Kings County, California</option>
<option value='Lake County, California'>Lake County, California</option>
<option value='Lassen County, California'>Lassen County, California</option>
<option value='Los Angeles County, California'>Los Angeles County, California</option>
<option value='Madera County, California'>Madera County, California</option>
<option value='Marin County, California'>Marin County, California</option>
<option value='Mariposa County, California'>Mariposa County, California</option>
<option value='Mendocino County, California'>Mendocino County, California</option>
<option value='Merced County, California'>Merced County, California</option>
<option value='Modoc County, California'>Modoc County, California</option>
<option value='Mono County, California'>Mono County, California</option>
<option value='Monterey County, California'>Monterey County, California</option>
<option value='Napa County, California'>Napa County, California</option>
<option value='Nevada County, California'>Nevada County, California</option>
<option value='Orange County, California'>Orange County, California</option>
<option value='Placer County, California'>Placer County, California</option>
<option value='Plumas County, California'>Plumas County, California</option>
<option value='Riverside County, California'>Riverside County, California</option>
<option value='Sacramento County, California'>Sacramento County, California</option>
<option value='San Benito County, California'>San Benito County, California</option>
<option value='San Bernardino County, California'>San Bernardino County, California</option>
<option value='San Diego County, California'>San Diego County, California</option>
<option value='San Francisco County, California'>San Francisco County, California</option>
<option value='San Joaquin County, California'>San Joaquin County, California</option>
<option value='San Luis Obispo County, California'>San Luis Obispo County, California</option>
<option value='San Mateo County, California'>San Mateo County, California</option>
<option value='Santa Barbara County, California'>Santa Barbara County, California</option>
<option value='Santa Clara County, California'>Santa Clara County, California</option>
<option value='Santa Cruz County, California'>Santa Cruz County, California</option>
<option value='Shasta County, California'>Shasta County, California</option>
<option value='Sierra County, California'>Sierra County, California</option>
<option value='Siskiyou County, California'>Siskiyou County, California</option>
<option value='Solano County, California'>Solano County, California</option>
<option value='Sonoma County, California'>Sonoma County, California</option>
<option value='Stanislaus County, California'>Stanislaus County, California</option>
<option value='Sutter County, California'>Sutter County, California</option>
<option value='Tehama County, California'>Tehama County, California</option>
<option value='Trinity County, California'>Trinity County, California</option>
<option value='Tulare County, California'>Tulare County, California</option>
<option value='Tuolumne County, California'>Tuolumne County, California</option>
<option value='Ventura County, California'>Ventura County, California</option>
<option value='Yolo County, California'>Yolo County, California</option>
<option value='Yuba County, California'>Yuba County, California</option>
      </select>
    <canvas id="barChart" width="850" height="500"></canvas>
    <script>  const ageData = {"Statewide":[-2.9,2.8,-3.4,3.2,-2,1.9,-3.1,2.9],"Alameda County, California":[-2.7,2.6,-2.9,2.7,-2.9,2.8,-1.8,1.7],"Alpine County, California":[-4.3,5.2,-4,0.9,-1.3,2,-2.4,2.5],"Amador County, California":[-2.1,1.8,-2,2.1,-2.6,1.9,-1.6,1.4],"Butte County, California":[-2.7,2.6,-3.1,2.7,-2.9,2.9,-1.9,1.7],"Calaveras County, California":[-2.2,1.9,-2.7,2,-1.8,2.8,-2.1,1.5],"Colusa County, California":[-3.3,3.3,-4.7,3.2,-3.4,4.2,-2.9,2.4],"Contra Costa County, California":[-2.7,2.6,-3,3,-3.5,3.2,-2.1,2],"Del Norte County, California":[-2.4,2.7,-3.5,2.2,-3.1,3.6,-2.6,0.8],"El Dorado County, California":[-2.3,2.2,-2.6,2.6,-3.2,2.9,-2,1.9],"Fresno County, California":[-3.6,3.5,-3.9,3.8,-4.4,4.1,-2.5,2.3],"Glenn County, California":[-3.4,3,-2.9,3.1,-5.1,3.8,-2.3,2.5],"Humboldt County, California":[-2.4,2.4,-2.8,2.7,-2.8,2.7,-1.7,1.6],"Imperial County, California":[-3.7,3.6,-3.6,3.9,-4.7,4.2,-2.5,2.3],"Inyo County, California":[-2.4,2.6,-2.5,2.9,-3.6,2.8,-2.1,1.4],"Kern County, California":[-3.7,3.5,-4.1,3.8,-4.4,4.3,-2.5,2.4],"Kings County, California":[-3.6,3.7,-3.4,3,-4.4,4.6,-2.3,2.1],"Lake County, California":[-2.8,2.7,-3.2,3.1,-3.3,2.9,-2,1.7],"Lassen County, California":[-2.4,2.3,-2.3,2.5,-2.8,2.4,-1.7,1.4],"Los Angeles County, California":[-2.7,2.6,-2.8,2.7,-3.3,3,-1.9,1.8],"Madera County, California":[-3.6,3.2,-3.9,3.6,-4.2,4,-2.5,2.4],"Marin County, California":[-2.3,2.2,-2.8,2.6,-3,3,-2.1,2],"Mariposa County, California":[-1,2.4,-3.7,2.3,-2.2,2.2,-1.4,1.7],"Mendocino County, California":[-2.5,2.8,-3.2,2.9,-2.9,3.1,-2,1.6],"Merced County, California":[-3.7,3.5,-4.1,4,-4.5,4.1,-2.7,2.5],"Modoc County, California":[-2.6,2.2,-3.1,3,-2.3,3.3,-0.7,2.2],"Mono County, California":[-3.7,1.5,-1.4,2.7,-5.1,1.1,-1.2,1.8],"Monterey County, California":[-3.4,3.3,-3.7,3.5,-3.9,3.7,-2.3,2.2],"Napa County, California":[-2.3,2.2,-2.8,2.3,-3,3.2,-2.1,1.9],"Nevada County, California":[-2.1,1.9,-2.5,2.1,-2.7,2.6,-1.6,1.6],"Orange County, California":[-2.8,2.6,-2.9,2.8,-3.3,3.1,-2,1.9],"Placer County, California":[-2.6,2.4,-3,2.8,-3.5,3.4,-2.1,2],"Plumas County, California":[-2.2,2.1,-1.9,2.8,-3,1.8,-2.5,1.2],"Riverside County, California":[-3,2.9,-3.4,3.2,-3.7,3.6,-2.3,2.2],"Sacramento County, California":[-3.1,2.9,-3.2,3,-3.5,3.3,-2,2],"San Benito County, California":[-3.1,3.3,-3.4,3.4,-3.9,3.7,-2.3,2.3],"San Bernardino County, California":[-3.3,3.2,-3.5,3.5,-4,3.7,-2.3,2.2],"San Diego County, California":[-2.9,2.8,-2.9,2.8,-3.2,3,-1.8,1.7],"San Francisco County, California":[-2.2,2.1,-1.9,1.8,-1.8,1.8,-1.1,1.1],"San Joaquin County, California":[-3.4,3.2,-3.6,3.3,-4.2,4.1,-2.5,2.3],"San Luis Obispo County, California":[-2.2,2.2,-2.3,2.5,-2.8,2.4,-1.6,1.6],"San Mateo County, California":[-2.7,2.5,-2.7,2.5,-3,2.9,-1.8,1.7],"Santa Barbara County, California":[-3.1,2.9,-3.1,2.7,-3.3,3.4,-1.9,1.9],"Santa Clara County, California":[-2.8,2.6,-2.9,2.7,-3.2,3,-2,1.9],"Santa Cruz County, California":[-2.3,2.3,-2.6,2.5,-2.9,2.6,-1.8,1.7],"Shasta County, California":[-2.8,2.7,-3.2,2.9,-3.3,3.1,-2,1.8],"Sierra County, California":[-0,0,-1.9,1.4,-3.1,4.2,-0.7,1.5],"Siskiyou County, California":[-2.5,2.3,-2.4,2.6,-3.6,3.3,-1.9,1.6],"Solano County, California":[-3,2.8,-3,3.1,-3.4,3,-1.9,1.9],"Sonoma County, California":[-2.4,2.3,-2.8,2.5,-2.8,2.9,-1.9,1.8],"Stanislaus County, California":[-3.4,3.3,-3.7,3.5,-4.2,4,-2.4,2.3],"Sutter County, California":[-3.3,3,-3.8,3.8,-3.8,3.1,-2.5,2.2],"Tehama County, California":[-2.9,2.9,-3.9,3.4,-3.3,3.4,-2.2,2],"Trinity County, California":[-1.8,2.5,-2.5,2.3,-3.4,2.7,-1.1,2.1],"Tulare County, California":[-3.8,3.6,-4.3,4,-4.6,4.5,-2.7,2.6],"Tuolumne County, California":[-2.4,2,-2.7,2.1,-2.3,2.6,-1.4,1.8],"Ventura County, California":[-2.7,2.6,-3,3,-3.5,3.2,-2.1,2],"Yolo County, California":[-2.5,2.4,-3,2.8,-3,3,-1.9,1.8],"Yuba County, California":[-3.8,3.5,-4.2,4.4,-3.6,3.6,-2.1,2]};
  const ageBins = ["0–4","5–9","10–14","15–17"];
  const ctx = document.getElementById('barChart').getContext('2d');
  let chart;

  function renderChart(data) {
    const maleData = data.filter((_, i) => i % 2 === 0);
    const femaleData = data.filter((_, i) => i % 2 === 1);

    const maxValue = Math.max(
      ...maleData.map(Math.abs),
      ...femaleData.map(Math.abs)
    );
    const padding = 1.0;
    const xMax = +(maxValue + padding).toFixed(1);

    if (chart) chart.destroy();
    chart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ageBins,
        datasets: [
          {
            label: 'Male',
            data: maleData,
            backgroundColor: 'darkslategray'
          },
          {
            label: 'Female',
            data: femaleData,
            backgroundColor: 'darkorange'
          }
        ]
      },
      options: {
        indexAxis: 'y',
        responsive: true,
        scales: {
          x: {
            min: -xMax,
            max: xMax,
            ticks: {
              callback: value => Math.abs(value).toFixed(1) + '%'
            }
          },
          y: {
            stacked: false
          }
        },
        plugins: {
          legend: {
            position: 'top',
            align: 'start',
            labels: {
              usePointStyle: true
            }
          },
          tooltip: {
            callbacks: {
              label: ctx => ctx.dataset.label + ': ' + Math.abs(ctx.parsed.x).toFixed(1) + '%'
            }
          }
        }
      }
    });
  }

  document.getElementById('countySelect').addEventListener('change', function() {
    renderChart(Object.values(ageData[this.value]));
  });

  renderChart(Object.values(ageData['Statewide']));</script>
  </body>
</html>
</html>
