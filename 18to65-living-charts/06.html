<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<style>body{background-color:white;}</style>

  <meta charset="UTF-8"/>
  <title>Living Arrangements 18–64 – California</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
      body { font-family: sans-serif; margin: 1.25rem 2rem; text-align: center; }
      h2 { margin-bottom: .25rem; font-size: 1.6rem; color: #2c348b; }
      label { margin-right: .5rem; }
      select { padding: .45rem .6rem; font-size: 1rem; border-radius: .5rem; border: 2px solid #f39c12; }
      canvas { width: 100%; max-width: 900px; height: 520px; }
    </style>
</head>
<html>
  <body>
    <h2>Living Arrangements of Adults 18–64 in California</h2>
    <label>Select County:</label>
    <select id="countySelect">
      <option value="Statewide">Statewide</option>
      <option value="Alameda County, California">Alameda County, California</option>
      <option value="Alpine County, California">Alpine County, California</option>
      <option value="Amador County, California">Amador County, California</option>
      <option value="Butte County, California">Butte County, California</option>
      <option value="Calaveras County, California">Calaveras County, California</option>
      <option value="Colusa County, California">Colusa County, California</option>
      <option value="Contra Costa County, California">Contra Costa County, California</option>
      <option value="Del Norte County, California">Del Norte County, California</option>
      <option value="El Dorado County, California">El Dorado County, California</option>
      <option value="Fresno County, California">Fresno County, California</option>
      <option value="Glenn County, California">Glenn County, California</option>
      <option value="Humboldt County, California">Humboldt County, California</option>
      <option value="Imperial County, California">Imperial County, California</option>
      <option value="Inyo County, California">Inyo County, California</option>
      <option value="Kern County, California">Kern County, California</option>
      <option value="Kings County, California">Kings County, California</option>
      <option value="Lake County, California">Lake County, California</option>
      <option value="Lassen County, California">Lassen County, California</option>
      <option value="Los Angeles County, California">Los Angeles County, California</option>
      <option value="Madera County, California">Madera County, California</option>
      <option value="Marin County, California">Marin County, California</option>
      <option value="Mariposa County, California">Mariposa County, California</option>
      <option value="Mendocino County, California">Mendocino County, California</option>
      <option value="Merced County, California">Merced County, California</option>
      <option value="Modoc County, California">Modoc County, California</option>
      <option value="Mono County, California">Mono County, California</option>
      <option value="Monterey County, California">Monterey County, California</option>
      <option value="Napa County, California">Napa County, California</option>
      <option value="Nevada County, California">Nevada County, California</option>
      <option value="Orange County, California">Orange County, California</option>
      <option value="Placer County, California">Placer County, California</option>
      <option value="Plumas County, California">Plumas County, California</option>
      <option value="Riverside County, California">Riverside County, California</option>
      <option value="Sacramento County, California">Sacramento County, California</option>
      <option value="San Benito County, California">San Benito County, California</option>
      <option value="San Bernardino County, California">San Bernardino County, California</option>
      <option value="San Diego County, California">San Diego County, California</option>
      <option value="San Francisco County, California">San Francisco County, California</option>
      <option value="San Joaquin County, California">San Joaquin County, California</option>
      <option value="San Luis Obispo County, California">San Luis Obispo County, California</option>
      <option value="San Mateo County, California">San Mateo County, California</option>
      <option value="Santa Barbara County, California">Santa Barbara County, California</option>
      <option value="Santa Clara County, California">Santa Clara County, California</option>
      <option value="Santa Cruz County, California">Santa Cruz County, California</option>
      <option value="Shasta County, California">Shasta County, California</option>
      <option value="Sierra County, California">Sierra County, California</option>
      <option value="Siskiyou County, California">Siskiyou County, California</option>
      <option value="Solano County, California">Solano County, California</option>
      <option value="Sonoma County, California">Sonoma County, California</option>
      <option value="Stanislaus County, California">Stanislaus County, California</option>
      <option value="Sutter County, California">Sutter County, California</option>
      <option value="Tehama County, California">Tehama County, California</option>
      <option value="Trinity County, California">Trinity County, California</option>
      <option value="Tulare County, California">Tulare County, California</option>
      <option value="Tuolumne County, California">Tuolumne County, California</option>
      <option value="Ventura County, California">Ventura County, California</option>
      <option value="Yolo County, California">Yolo County, California</option>
      <option value="Yuba County, California">Yuba County, California</option>
    </select>
    <canvas id="barChart"></canvas>
    <script>document.addEventListener("DOMContentLoaded", function () {
  const data = {"Statewide":[8,18.2,7.6,15.4,42.9,7.9],"Alameda County, California":[9,14.9,9.3,13.6,45.7,7.4],"Alpine County, California":[6.7,31.7,3.8,12,39.2,6.7],"Amador County, California":[10.5,17.4,4.3,9.7,51.4,6.6],"Butte County, California":[10,12.1,14.5,11.2,39.6,12.6],"Calaveras County, California":[6.9,17.6,6.5,10,52.4,6.7],"Colusa County, California":[6.8,18.3,2.6,14.7,50.8,6.8],"Contra Costa County, California":[6.7,17.3,5.7,13.7,49.4,7.3],"Del Norte County, California":[8.5,17.9,4.2,12.5,47.2,9.6],"El Dorado County, California":[7.8,14.9,5.6,9.2,55.6,6.8],"Fresno County, California":[7.3,19.4,5.5,18,41,8.7],"Glenn County, California":[8.5,19,2.8,15.1,45.1,9.5],"Humboldt County, California":[12.9,13,11.1,11.3,36.2,15.6],"Imperial County, California":[5.8,27.2,4.3,19.5,39,4.2],"Inyo County, California":[16.1,12.8,4,13.7,46.4,6.9],"Kern County, California":[6.7,19.7,4.6,16.6,43.5,9.1],"Kings County, California":[5.8,19.5,4.8,16.9,45.3,7.5],"Lake County, California":[11.6,18,6.4,13.7,37.5,12.8],"Lassen County, California":[8.3,15.7,4.6,16.1,46.1,9.1],"Los Angeles County, California":[9.4,19.6,7.6,17.7,37.6,8.1],"Madera County, California":[4.2,22.6,5.4,17.5,40.8,9.4],"Marin County, California":[9.2,13.6,6.7,10.2,51.9,8.5],"Mariposa County, California":[17.6,5.9,2.9,7.1,54.1,12.4],"Mendocino County, California":[10.5,17.7,8.2,15.7,38.7,9.2],"Merced County, California":[6.4,22.3,4.6,19.1,38.8,8.8],"Modoc County, California":[11.6,19.5,7.3,13.7,44.3,3.5],"Mono County, California":[15,10.5,5.2,6.9,52.2,10.3],"Monterey County, California":[5.6,18.1,7,16.3,42.9,10.1],"Napa County, California":[7.4,17.2,6.5,14.4,47.4,7.2],"Nevada County, California":[9,13.4,7.7,11.1,49.3,9.5],"Orange County, California":[6.8,18.6,7.8,14.6,45.8,6.4],"Placer County, California":[7,15.4,4.9,9.8,56.5,6.4],"Plumas County, California":[10,15.1,8.3,9.9,47.5,9.3],"Riverside County, California":[5,21.7,5.6,16.5,44.7,6.6],"Sacramento County, California":[9.2,16.2,6.7,15.9,43.1,8.8],"San Benito County, California":[4.4,22.7,5.1,14.8,46.2,6.7],"San Bernardino County, California":[5.3,22.1,5,17.6,42.2,7.7],"San Diego County, California":[8.8,15.7,9.1,13.6,45.3,7.6],"San Francisco County, California":[17.1,9.2,16.7,10.5,35.7,10.8],"San Joaquin County, California":[5.8,20.7,4.7,16.9,44.1,7.7],"San Luis Obispo County, California":[8.8,12.7,14.3,9.4,46.1,8.6],"San Mateo County, California":[8.1,16.1,8.1,13.1,47.9,6.8],"Santa Barbara County, California":[7.5,16.6,12.5,12.9,40.7,9.7],"Santa Clara County, California":[7.5,15.3,9,13.2,48.5,6.5],"Santa Cruz County, California":[7.8,16.1,12,10.6,43.8,9.7],"Shasta County, California":[9.8,13.7,9.1,11.8,44.7,10.9],"Sierra County, California":[18.9,25.6,4.8,3.7,47.1,0],"Siskiyou County, California":[12.9,11.2,7,12.3,46,10.6],"Solano County, California":[8,18.6,5.5,16.4,43.8,7.7],"Sonoma County, California":[8.8,14.9,8,12,45.9,10.5],"Stanislaus County, California":[6,21.2,5.1,15.9,44.3,7.5],"Sutter County, California":[7,17.6,5.1,17.2,44.4,8.6],"Tehama County, California":[8.5,16.3,4.9,13.9,49.5,6.9],"Trinity County, California":[16.2,21.5,25.4,5.5,23.6,7.8],"Tulare County, California":[4.5,21.5,3.6,17.9,43.7,8.8],"Tuolumne County, California":[12.7,12.3,7.1,12.4,46.2,9.4],"Ventura County, California":[6,21.1,6.2,14.3,45,7.5],"Yolo County, California":[7.5,13.4,17.7,11,41,9.3],"Yuba County, California":[7.5,15.9,5.6,15.2,45.1,10.7]};
  const cats = ["lives_alone_18_64","with_child_18_64","with_nonrel_18_64","with_other_rel_18_64","with_spouse_only_18_64","with_unmar_partner_18_64"];

  const ORDER = [
    "Lives alone",
    "With child",
    "With nonrelatives",
    "With other relatives",
    "With spouse only",
    "With unmarried partner"
  ];

  const PRETTY_TO_SNAKE = {
    "Lives alone":            "lives_alone_18_64",
    "With child":             "with_child_18_64",
    "With nonrelatives":      "with_nonrel_18_64",
    "With other relatives":   "with_other_rel_18_64",
    "With spouse only":       "with_spouse_only_18_64",
    "With unmarried partner": "with_unmar_partner_18_64"
  };

  const COLOR_BY_CAT = {
    "Lives alone":            "#e41a1c",
    "With child":             "#ff7f00",
    "With nonrelatives":      "#4daf4a",
    "With other relatives":   "#984ea3",
    "With spouse only":       "#377eb8",
    "With unmarried partner": "#a65628"
  };

  // snake key → array index
  const keyToIndex = Object.fromEntries((cats || []).map((k, i) => [String(k), i]));

  function valuesFor(name) {
    const row = data?.[name] || [];
    return ORDER.map(lbl => {
      const idx = keyToIndex[PRETTY_TO_SNAKE[lbl]];
      const v = (idx != null && idx >= 0) ? row[idx] : 0;
      return (typeof v === "number") ? v : Number(v) || 0;
    });
  }

  const canvas = document.getElementById("barChart");
  if (!canvas) return;
  const ctx = canvas.getContext("2d");
  let chart;

  function renderChart(name) {
    const vals = valuesFor(name);
    if (chart) chart.destroy();
    chart = new Chart(ctx, {
      type: "bar",
      data: {
        labels: ORDER,
        datasets: [{
          data: vals,
          backgroundColor: ORDER.map(c => COLOR_BY_CAT[c]),
          borderWidth: 0
        }]
      },
      options: {
        indexAxis: "y",
        plugins: {
          legend: { display: false },
          tooltip: { callbacks: { label: (c) => c.raw + "%" } }
        },
        scales: {
          x: { min: 0, max: 100, ticks: { callback: v => v + "%" } }
        }
      }
    });
  }

  const DEFAULT_NAME = (data && Object.prototype.hasOwnProperty.call(data, "Statewide"))
    ? "Statewide" : Object.keys(data || {})[0];

  const sel = document.getElementById("countySelect");
  if (sel) sel.addEventListener("change", e => renderChart(e.target.value));
  if (DEFAULT_NAME) renderChart(DEFAULT_NAME);
});</script>
  </body>
</html>
</html>
